# 更新日志

本文档记录 MaiMaiNotePad 后端项目的所有重要变更。

版本号格式遵循 [语义化版本](https://semver.org/lang/zh-CN/)：主版本号.次版本号.修订号

## [2.2.1] - 2026-02-24

### 修复
- 修复所有异常处理中缺失的异常链（B904），添加 `from e` 或 `from None`
- 修复内置名称遮蔽问题（A004）：Redis 异常使用别名 `RedisConnectionError`、`RedisTimeoutError`
- 修复内置参数遮蔽问题（A002）：`type` → `star_type`，`format` → `img_format`
- 修复导入别名命名规范（N812）：`HTTPStatus` → `http_status`
- 修复测试代码中的变量命名、类名、未使用变量等问题

### 改进
- 代码质量全面提升，通过 Ruff 和 Mypy 所有检查
- 完善异常堆栈信息，便于调试
- 统一命名规范，符合 PEP 8 标准

## [2.2.0] - 2026-02-24

### 新增
- 集成 AI 内容审核功能（基于百度智能云）
- 新增 `ModerationService` 服务，支持文本内容审核
- 新增审核 API 端点：`/api/moderation/check` 和 `/api/moderation/health`
- 支持多种文本类型审核：评论、知识库、角色卡等
- 提供审核结果缓存机制，优化性能
- 新增审核功能演示脚本 `examples/moderation_demo.py`

### 文档
- 新增审核功能使用文档
- 更新 API 文档，包含审核接口说明

## [2.1.1] - 2026-02-24

### 新增
- 实现通用缓存失效机制
- 支持单键失效、模式匹配批量失效
- 提供缓存失效装饰器和工具函数

### 改进
- 优化缓存管理器性能
- 完善缓存日志记录

## [2.1.0] - 2026-02-24

### 新增
- 集成 Redis 缓存机制
- 实现缓存装饰器 `@cache_result`
- 支持缓存指标监控
- 新增缓存中间件

### 改进
- 优化测试套件，提升测试覆盖率
- 完善缓存配置管理

### 文档
- 新增缓存使用指南
- 更新配置文档

## [2.0.1] - 2026-02-22

### 改进
- 优化项目文件结构
- 完善版本管理机制
- 统一版本号来源（Single Source of Truth）

### 文档
- 更新项目文档结构
- 完善开发指南

## [2.0.0] - 2026-02-22

### 重大变更
- 项目架构重构完成
- 采用分层架构：API 层、服务层、数据层、工具层
- 实现依赖注入模式

### 新增
- 完整的用户认证和授权系统
- 知识库管理功能
- 角色卡管理功能
- 评论系统
- 消息系统
- 管理员功能

### 改进
- 统一错误处理机制
- 结构化日志系统
- 完善的测试覆盖

## [1.0.0] - 2026-02-20

### 新增
- 项目初始版本发布
- 基础 API 框架搭建
- 数据库模型设计
- 基础功能实现

---

## 版本说明

- **主版本号**：重大变更，可能不向后兼容
- **次版本号**：新增功能，向后兼容
- **修订号**：Bug 修复和小改进，向后兼容

## 贡献指南

提交代码时，请确保：
1. 遵循项目代码规范（见 `specification.md`）
2. 通过所有代码质量检查（Ruff、Mypy）
3. 通过所有测试用例
4. 更新相关文档
5. 在本文件中记录变更
