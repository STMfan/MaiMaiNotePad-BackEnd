# 管理工具快速参考

## 快速开始

```bash
# 交互式菜单
./manage.sh

# 查看帮助
./manage.sh help
```

## 智能环境检测

管理工具会自动检测你的 Conda 环境：

- ✅ 如果当前环境是推荐环境，直接继续
- ⚠️ 如果当前环境不是推荐环境，提供选项：
  - 继续使用当前环境
  - 查看并切换到其他环境（列出所有可用环境）
  - 取消操作
- 🔍 如果安装了 Conda 但未激活，提示激活环境

**环境切换示例：**
```
可用的 Conda 环境：

  1. base (当前)
  2. mai_notebook (推荐)
  3. AlbumVision
  4. MaiBotEnv
  
  0. 不切换，继续使用当前环境

请选择要激活的环境 [0-4]: 2
```

## 常用命令

### 环境管理
```bash
./manage.sh create-env      # 创建虚拟环境
./manage.sh status          # 查看项目状态
./manage.sh deps-install    # 安装依赖
```

### 服务管理
```bash
./manage.sh start-dev       # 启动开发服务器
./manage.sh start-prod      # 启动生产服务器
./manage.sh docker-start    # 启动 Redis
```

### 测试
```bash
./manage.sh test            # 运行所有测试
./manage.sh test-unit       # 运行单元测试
./manage.sh test-cov        # 生成覆盖率报告
```

### 项目维护
```bash
./manage.sh cleanup         # 清理项目
./manage.sh lint            # 代码质量检查
./manage.sh db-upgrade      # 升级数据库
```

## 菜单结构

```
主菜单
├── 1. 环境管理
│   ├── 创建虚拟环境
│   ├── 查看项目状态
│   ├── 依赖管理
│   └── 配置管理
├── 2. 服务管理
│   ├── 启动服务（开发模式）
│   ├── 启动服务（生产模式）
│   └── Docker 管理
├── 3. 测试相关
│   ├── 运行所有测试
│   ├── 运行单元测试
│   ├── 运行集成测试
│   ├── 详细模式测试
│   ├── 生成覆盖率报告
│   └── 完整测试流程
├── 4. 项目维护
│   ├── 清理项目
│   ├── 数据库管理
│   ├── 代码质量检查
│   ├── 生成文档
│   └── 查看日志
└── 5. 高级操作
    ├── 初始化超级管理员
    └── 清档重置
```

## 配置环境切换

```bash
# 查看当前配置
./manage.sh config-show

# 切换环境
./manage.sh config-switch dev      # 开发环境
./manage.sh config-switch prod     # 生产环境
./manage.sh config-switch degraded # 降级模式

# 验证配置
./manage.sh config-validate
```

## 虚拟环境类型

| 类型 | 特点 | 推荐场景 |
|------|------|---------|
| Conda | 可指定 Python 版本，强大的包管理 | 推荐使用 |
| venv | Python 内置，轻量级 | 简单项目 |
| uv | 极快的包管理器 | 追求速度 |

## 测试配置

测试配置文件：`tests/.test_env`

```bash
TEST_PARALLEL=true              # 是否启用并行测试
TEST_WORKERS=auto               # 并行工作进程数
RECOMMENDED_CONDA_ENV=mai_notebook  # 推荐的 Conda 环境
```

## 更多信息

详细使用说明请参考：[管理工具使用指南](./管理工具使用指南.md)
