# API æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº† MaiMNP åç«¯ API çš„æ¥å£è§„èŒƒã€‚API åŸºäº FastAPI æ¡†æ¶æ„å»ºï¼Œæä¾›ç”¨æˆ·ç®¡ç†ã€çŸ¥è¯†åº“ç®¡ç†ã€äººè®¾å¡ç®¡ç†ã€å®¡æ ¸ç®¡ç†ã€æ¶ˆæ¯ç®¡ç†ã€é‚®ä»¶æœåŠ¡ç­‰åŠŸèƒ½ã€‚

## åŸºç¡€ä¿¡æ¯

- **åŸºç¡€URL**: `http://0.0.0.0:9278`ï¼ˆæœ¬åœ°å¯é€šè¿‡ `http://localhost:9278` è®¿é—®ï¼‰
- **APIç‰ˆæœ¬**: v1
- **è®¤è¯æ–¹å¼**: Bearer Token (JWT)
- **Content-Type**: æ”¯æŒ `application/json` å’Œ `application/x-www-form-urlencoded`

## ç³»ç»Ÿçº§æ¥å£

### æ¬¢è¿é¡µ
è¿”å›å›ºå®šæ¬¢è¿æ–‡æ¡ˆï¼Œå¯ç”¨äºå¿«é€ŸéªŒè¯æœåŠ¡æ˜¯å¦åœ¨çº¿ã€‚

```http
GET /
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "Welcome to MaiMaiNotePad"
}
```

### å¥åº·æ£€æŸ¥
æä¾›å¥åº·æ£€æŸ¥æ¥å£ï¼Œè¿”å›é™æ€çŠ¶æ€ã€‚

```http
GET /health
```

**å“åº”ç¤ºä¾‹**:
```json
{ "status": "healthy" }
```

## è®¤è¯ç›¸å…³æ¥å£

### ç”¨æˆ·ç™»å½•
è·å–è®¿é—®ä»¤ç‰Œï¼Œæ”¯æŒ JSON å’Œè¡¨å•æ•°æ®æ ¼å¼ã€‚

```http
POST /api/token
Content-Type: application/json

{
  "username": "string",
  "password": "string"
}
```

æˆ–

```http
POST /api/token
Content-Type: application/x-www-form-urlencoded

username=string&password=string
```

**å‚æ•°è¯´æ˜**:
- `username` (å¿…å¡«): ç”¨æˆ·å
- `password` (å¿…å¡«): å¯†ç 

**å“åº”ç¤ºä¾‹**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "expires_in": 900,
  "user": {
    "id": "user123",
    "username": "testuser",
    "email": "user@example.com",
    "role": "user"
  }
}
```

**é”™è¯¯å“åº”**:
- `400`: ç”¨æˆ·åæˆ–å¯†ç ä¸ºç©º
- `401`: ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯

### å‘é€éªŒè¯ç 
å‘æŒ‡å®šé‚®ç®±å‘é€éªŒè¯ç ï¼Œç”¨äºæ³¨å†ŒéªŒè¯ã€‚

```http
POST /api/send_verification_code
Content-Type: application/x-www-form-urlencoded

email=user@example.com
```

**å‚æ•°è¯´æ˜**:
- `email` (å¿…å¡«): æ¥æ”¶éªŒè¯ç çš„é‚®ç®±åœ°å€

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "éªŒè¯ç å·²å‘é€"
}
```

**é”™è¯¯å“åº”**:
- `400`: é‚®ç®±æ ¼å¼æ— æ•ˆ
- `429`: è¯·æ±‚å‘é€éªŒè¯ç è¿‡äºé¢‘ç¹
- `500`: å‘é€éªŒè¯ç å¤±è´¥

### ç”¨æˆ·æ³¨å†Œ
ä½¿ç”¨é‚®ç®±éªŒè¯ç æ³¨å†Œæ–°ç”¨æˆ·ã€‚

```http
POST /api/user/register
Content-Type: application/x-www-form-urlencoded

username=newuser&password=pass123&email=user@example.com&verification_code=123456
```

**å‚æ•°è¯´æ˜**:
- `username` (å¿…å¡«): ç”¨æˆ·åï¼Œéœ€å”¯ä¸€
- `password` (å¿…å¡«): å¯†ç 
- `email` (å¿…å¡«): é‚®ç®±åœ°å€
- `verification_code` (å¿…å¡«): é‚®ç®±éªŒè¯ç 

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: æœ‰æœªå¡«å†™çš„å­—æ®µã€éªŒè¯ç é”™è¯¯æˆ–å·²å¤±æ•ˆã€ç”¨æˆ·å/é‚®ç®±å·²å­˜åœ¨
- `500`: æ³¨å†Œå¤±è´¥ï¼Œç³»ç»Ÿé”™è¯¯

### å‘é€é‡ç½®å¯†ç éªŒè¯ç 
å‘å·²æ³¨å†Œé‚®ç®±å‘é€å¯†ç é‡ç½®éªŒè¯ç ï¼Œè§¦å‘é¢‘ç‡å—é™ã€‚

```http
POST /api/send_reset_password_code
Content-Type: application/x-www-form-urlencoded

email=user@example.com
```

**å‚æ•°è¯´æ˜**:
- `email` (å¿…å¡«): æ¥æ”¶éªŒè¯ç çš„é‚®ç®±åœ°å€ï¼Œå¿…é¡»å·²æ³¨å†Œ

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "éªŒè¯ç å·²å‘é€"
}
```

**é”™è¯¯å“åº”**:
- `400`: é‚®ç®±æ ¼å¼æ— æ•ˆæˆ–é‚®ç®±æœªæ³¨å†Œ
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: å‘é€éªŒè¯ç å¤±è´¥

### é‡ç½®å¯†ç 
ä½¿ç”¨é‚®ç®±éªŒè¯ç é‡ç½®è´¦å·å¯†ç ã€‚

```http
POST /api/reset_password
Content-Type: application/x-www-form-urlencoded

email=user@example.com&verification_code=123456&new_password=newPass
```

**å‚æ•°è¯´æ˜**:
- `email` (å¿…å¡«): é‚®ç®±åœ°å€
- `verification_code` (å¿…å¡«): é‚®ä»¶æ”¶åˆ°çš„éªŒè¯ç 
- `new_password` (å¿…å¡«): æ–°å¯†ç 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å¯†ç é‡ç½®æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: å‚æ•°ç¼ºå¤±æˆ–éªŒè¯ç é”™è¯¯/å¤±æ•ˆ
- `500`: é‡ç½®å¤±è´¥

### è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€‚

```http
GET /api/users/me
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "user123",
  "username": "testuser",
  "email": "user@example.com",
  "role": "user"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "user123",
  "username": "testuser",
  "email": "user@example.com",
  "role": "user",
  "avatar_url": "/uploads/avatars/user123.jpg",
  "avatar_updated_at": "2025-11-22T00:00:00"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥

### åˆ·æ–°è®¿é—®ä»¤ç‰Œ
ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚

```http
POST /api/refresh
Content-Type: application/json

{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

æˆ–

```http
POST /api/refresh
Content-Type: application/x-www-form-urlencoded

refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**å‚æ•°è¯´æ˜**:
- `refresh_token` (å¿…å¡«): åˆ·æ–°ä»¤ç‰Œ

**å“åº”ç¤ºä¾‹**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "expires_in": 900
}
```

**é”™è¯¯å“åº”**:
- `400`: åˆ·æ–°ä»¤ç‰Œä¸ºç©º
- `401`: æ— æ•ˆçš„åˆ·æ–°ä»¤ç‰Œ
- `500`: åˆ·æ–°ä»¤ç‰Œå¤±è´¥

### ä¿®æ”¹å¯†ç 
ä¿®æ”¹å½“å‰ç”¨æˆ·çš„å¯†ç ã€‚

```http
PUT /api/users/me/password
Authorization: Bearer {token}
Content-Type: application/json

{
  "current_password": "oldpass123",
  "new_password": "newpass123",
  "confirm_password": "newpass123"
}
```

**å‚æ•°è¯´æ˜**:
- `current_password` (å¿…å¡«): å½“å‰å¯†ç 
- `new_password` (å¿…å¡«): æ–°å¯†ç ï¼ˆé•¿åº¦ä¸èƒ½å°‘äº6ä½ï¼‰
- `confirm_password` (å¿…å¡«): ç¡®è®¤æ–°å¯†ç 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: æœ‰æœªå¡«å†™çš„å­—æ®µã€æ–°å¯†ç ä¸ç¡®è®¤å¯†ç ä¸åŒ¹é…ã€å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½ã€å½“å‰å¯†ç é”™è¯¯
- `401`: æœªæˆæƒè®¿é—®
- `500`: ä¿®æ”¹å¯†ç å¤±è´¥

### ä¸Šä¼ å¤´åƒ
ä¸Šä¼ å½“å‰ç”¨æˆ·çš„å¤´åƒã€‚

```http
POST /api/users/me/avatar
Authorization: Bearer {token}
Content-Type: multipart/form-data

avatar: [å›¾ç‰‡æ–‡ä»¶]
```

**å‚æ•°è¯´æ˜**:
- `avatar` (å¿…å¡«): å¤´åƒå›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒ JPGã€JPEGã€PNGã€GIFã€WEBP æ ¼å¼ï¼Œæœ€å¤§ 2MBï¼Œæœ€å¤§å°ºå¯¸ 1024x1024 åƒç´ 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å¤´åƒä¸Šä¼ æˆåŠŸ",
  "avatar_url": "/uploads/avatars/user123.jpg",
  "avatar_updated_at": "2025-11-22T00:00:00"
}
```

**é”™è¯¯å“åº”**:
- `400`: æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒã€æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ã€å›¾ç‰‡å¤„ç†å¤±è´¥
- `401`: æœªæˆæƒè®¿é—®
- `500`: ä¸Šä¼ å¤´åƒå¤±è´¥

### åˆ é™¤å¤´åƒ
åˆ é™¤å½“å‰ç”¨æˆ·çš„å¤´åƒã€‚

```http
DELETE /api/users/me/avatar
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å¤´åƒåˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `500`: åˆ é™¤å¤´åƒå¤±è´¥

### è·å–ç”¨æˆ·å¤´åƒ
è·å–æŒ‡å®šç”¨æˆ·çš„å¤´åƒï¼ˆå¦‚æœç”¨æˆ·æ²¡æœ‰ä¸Šä¼ å¤´åƒï¼Œå°†è¿”å›è‡ªåŠ¨ç”Ÿæˆçš„å¤´åƒï¼‰ã€‚

```http
GET /api/users/{user_id}/avatar?size=200
```

**å‚æ•°è¯´æ˜**:
- `user_id` (è·¯å¾„å‚æ•°): ç”¨æˆ·ID
- `size` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): å¤´åƒå°ºå¯¸ï¼Œé»˜è®¤200

**å“åº”**:
- è¿”å›å›¾ç‰‡æ–‡ä»¶æµï¼ŒContent-Type: `image/jpeg` æˆ– `image/png`

**é”™è¯¯å“åº”**:
- `404`: ç”¨æˆ·ä¸å­˜åœ¨
- `500`: è·å–å¤´åƒå¤±è´¥

### å‘é€é‡ç½®å¯†ç éªŒè¯ç 
å‘æŒ‡å®šé‚®ç®±å‘é€é‡ç½®å¯†ç éªŒè¯ç ã€‚

```http
POST /api/send_reset_password_code
Content-Type: application/x-www-form-urlencoded

email=user@example.com
```

**å‚æ•°è¯´æ˜**:
- `email` (å¿…å¡«): æ¥æ”¶éªŒè¯ç çš„é‚®ç®±åœ°å€ï¼ˆå¿…é¡»æ˜¯å·²æ³¨å†Œçš„é‚®ç®±ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "é‡ç½®å¯†ç éªŒè¯ç å·²å‘é€"
}
```

**é”™è¯¯å“åº”**:
- `400`: é‚®ç®±æ ¼å¼æ— æ•ˆã€è¯¥é‚®ç®±æœªæ³¨å†Œ
- `429`: è¯·æ±‚å‘é€éªŒè¯ç è¿‡äºé¢‘ç¹
- `500`: å‘é€éªŒè¯ç å¤±è´¥

### é‡ç½®å¯†ç 
é€šè¿‡é‚®ç®±éªŒè¯ç é‡ç½®å¯†ç ã€‚

```http
POST /api/reset_password
Content-Type: application/x-www-form-urlencoded

email=user@example.com&verification_code=123456&new_password=newpass123
```

**å‚æ•°è¯´æ˜**:
- `email` (å¿…å¡«): é‚®ç®±åœ°å€
- `verification_code` (å¿…å¡«): é‚®ç®±éªŒè¯ç 
- `new_password` (å¿…å¡«): æ–°å¯†ç ï¼ˆé•¿åº¦ä¸èƒ½å°‘äº6ä½ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "å¯†ç é‡ç½®æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: æœ‰æœªå¡«å†™çš„å­—æ®µã€å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½ã€éªŒè¯ç é”™è¯¯æˆ–å·²å¤±æ•ˆ
- `500`: é‡ç½®å¯†ç å¤±è´¥

## çŸ¥è¯†åº“ç®¡ç†æ¥å£

### ä¸Šä¼ çŸ¥è¯†åº“
ä¸Šä¼ çŸ¥è¯†åº“æ–‡ä»¶ï¼Œæ”¯æŒå¤šä¸ªæ–‡ä»¶åŒæ—¶ä¸Šä¼ ã€‚

```http
POST /api/knowledge/upload
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
name: çŸ¥è¯†åº“åç§°
description: çŸ¥è¯†åº“æè¿°
copyright_owner: ç‰ˆæƒæ‰€æœ‰è€…ï¼ˆå¯é€‰ï¼‰
```

**å‚æ•°è¯´æ˜**:
- `files` (å¿…å¡«): çŸ¥è¯†åº“æ–‡ä»¶åˆ—è¡¨ï¼Œè‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `name` (å¿…å¡«): çŸ¥è¯†åº“åç§°
- `description` (å¿…å¡«): çŸ¥è¯†åº“æè¿°
- `copyright_owner` (å¯é€‰): ç‰ˆæƒæ‰€æœ‰è€…ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "kb123",
  "name": "æˆ‘çš„çŸ¥è¯†åº“",
  "description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•çŸ¥è¯†åº“",
  "uploader_id": "user123",
  "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
  "star_count": 0,
  "is_public": false,
  "is_pending": true,
  "created_at": "2025-11-22T00:00:00",
  "updated_at": "2025-11-22T00:00:00"
}
```

**é”™è¯¯å“åº”**:
- `400`: åç§°å’Œæè¿°ä¸èƒ½ä¸ºç©ºã€è‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `500`: ä¸Šä¼ çŸ¥è¯†åº“å¤±è´¥

### è·å–å…¬å¼€çŸ¥è¯†åº“åˆ—è¡¨
è·å–æ‰€æœ‰å·²å®¡æ ¸é€šè¿‡çš„å…¬å¼€çŸ¥è¯†åº“åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰å’Œæ’åºã€‚

```http
GET /api/knowledge/public?page=1&page_size=20&name=&uploader_id=&sort_by=created_at&sort_order=desc
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼ŒèŒƒå›´1-100ï¼Œé»˜è®¤ä¸º20
- `name` (å¯é€‰): æŒ‰åç§°æœç´¢ï¼Œæ”¯æŒæ¨¡ç³ŠåŒ¹é…
- `uploader_id` (å¯é€‰): æŒ‰ä¸Šä¼ è€…IDç­›é€‰
- `sort_by` (å¯é€‰): æ’åºå­—æ®µï¼Œå¯é€‰å€¼ï¼š`created_at`ã€`updated_at`ã€`star_count`ï¼Œé»˜è®¤ä¸º `created_at`
- `sort_order` (å¯é€‰): æ’åºé¡ºåºï¼Œå¯é€‰å€¼ï¼š`asc`ã€`desc`ï¼Œé»˜è®¤ä¸º `desc`

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [
    {
      "id": "kb123",
      "name": "å…¬å¼€çŸ¥è¯†åº“",
      "description": "è¿™æ˜¯ä¸€ä¸ªå…¬å¼€çš„çŸ¥è¯†åº“",
      "uploader_id": "user123",
      "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
      "star_count": 10,
      "is_public": true,
      "is_pending": false,
      "created_at": "2025-11-22T00:00:00",
      "updated_at": "2025-11-22T00:00:00"
    }
  ],
  "total": 100,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `400`: æŸ¥è¯¢å‚æ•°æ— æ•ˆï¼ˆå¦‚page_sizeè¶…å‡ºèŒƒå›´ï¼‰
- `500`: è·å–å…¬å¼€çŸ¥è¯†åº“å¤±è´¥

### è·å–çŸ¥è¯†åº“å†…å®¹
è·å–æŒ‡å®šçŸ¥è¯†åº“çš„è¯¦ç»†å†…å®¹ã€‚

```http
GET /api/knowledge/{kb_id}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "content": "çŸ¥è¯†åº“å†…å®¹...",
  "metadata": {
    "file_count": 2,
    "total_size": 1024
  }
}
```

**é”™è¯¯å“åº”**:
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: è·å–çŸ¥è¯†åº“å†…å®¹å¤±è´¥

### è·å–ç”¨æˆ·çš„çŸ¥è¯†åº“åˆ—è¡¨
è·å–æŒ‡å®šç”¨æˆ·ä¸Šä¼ çš„æ‰€æœ‰çŸ¥è¯†åº“ã€‚

```http
GET /api/knowledge/user/{user_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `user_id` (è·¯å¾„å‚æ•°): ç”¨æˆ·ID

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "kb123",
    "name": "æˆ‘çš„çŸ¥è¯†åº“",
    "description": "ç”¨æˆ·çŸ¥è¯†åº“æè¿°",
    "uploader_id": "user123",
    "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
    "star_count": 5,
    "is_public": false,
    "is_pending": true,
    "created_at": "2025-11-22T00:00:00",
    "updated_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰æƒé™æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„ä¸Šä¼ è®°å½•
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·çŸ¥è¯†åº“å¤±è´¥

### æ›´æ–°çŸ¥è¯†åº“ä¿¡æ¯
æ›´æ–°çŸ¥è¯†åº“å…ƒä¿¡æ¯ï¼Œä»…é™ä¸Šä¼ è€…ã€ç®¡ç†å‘˜æˆ–å®¡æ ¸å‘˜ã€‚

```http
PUT /api/knowledge/{kb_id}
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "æ–°çš„åç§°",
  "description": "æ–°çš„æè¿°",
  "copyright_owner": "æ–°çš„ç‰ˆæƒæ‰€æœ‰è€…"
}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `name`/`description` (å¯é€‰): ä¸ºç©ºåˆ™ä¸æ›´æ–°
- `copyright_owner` (å¯é€‰)

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: æ›´æ–°å¤±è´¥

### æ·»åŠ çŸ¥è¯†åº“æ–‡ä»¶
ä¸ºçŸ¥è¯†åº“è¿½åŠ æ–‡ä»¶ã€‚

```http
POST /api/knowledge/{kb_id}/files
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `files` (å¿…å¡«): è‡³å°‘ä¸€ä¸ªæ–‡ä»¶

**é”™è¯¯å“åº”**:
- `400`: æœªä¸Šä¼ æ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: ä¸Šä¼ å¤±è´¥

### åˆ é™¤çŸ¥è¯†åº“æ–‡ä»¶
æŒ‰æ–‡ä»¶IDåˆ é™¤çŸ¥è¯†åº“ä¸­æ–‡ä»¶ã€‚

```http
DELETE /api/knowledge/{kb_id}/{file_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id`: çŸ¥è¯†åº“ID
- `file_id`: æ–‡ä»¶ID

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: æ–‡ä»¶æˆ–çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: åˆ é™¤å¤±è´¥

### ä¸‹è½½çŸ¥è¯†åº“å…¨éƒ¨æ–‡ä»¶
ä»¥ ZIP å½¢å¼ä¸‹è½½çŸ¥è¯†åº“å…¨éƒ¨æ–‡ä»¶ã€‚

```http
GET /api/knowledge/{kb_id}/download
Authorization: Bearer {token}
```

**è¯´æ˜**: å¯¹ç§æœ‰çŸ¥è¯†åº“ä»…ä¸Šä¼ è€…æˆ–ç®¡ç†å‘˜å¯ä¸‹è½½ã€‚

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ— æƒä¸‹è½½
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: æ‰“åŒ…å¤±è´¥

### ä¸‹è½½å•ä¸ªçŸ¥è¯†åº“æ–‡ä»¶
ä¸‹è½½æŒ‡å®šæ–‡ä»¶ã€‚

```http
GET /api/knowledge/{kb_id}/file/{file_id}
Authorization: Bearer {token}
```

**è¯´æ˜**: ç§æœ‰çŸ¥è¯†åº“æ–‡ä»¶ä»…ä¸Šä¼ è€…æˆ–ç®¡ç†å‘˜å¯è®¿é—®ã€‚

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ— æƒä¸‹è½½
- `404`: æ–‡ä»¶ä¸å­˜åœ¨
- `500`: ä¸‹è½½å¤±è´¥

### åˆ é™¤çŸ¥è¯†åº“
åˆ é™¤æ•´ä¸ªçŸ¥è¯†åº“åŠå…¶æ–‡ä»¶ã€‚

```http
DELETE /api/knowledge/{kb_id}
Authorization: Bearer {token}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: åˆ é™¤å¤±è´¥

### Star/å–æ¶ˆStarçŸ¥è¯†åº“
å¯¹çŸ¥è¯†åº“è¿›è¡ŒStaræˆ–å–æ¶ˆStaræ“ä½œï¼Œæ¥å£ä¼šæ ¹æ®å½“å‰çŠ¶æ€è‡ªåŠ¨åˆ‡æ¢ã€‚

```http
POST /api/knowledge/{kb_id}/star
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "StaræˆåŠŸ"
}
```

æˆ–

```json
{
  "message": "å–æ¶ˆStaræˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `401`: æœªæˆæƒè®¿é—®
- `500`: StarçŸ¥è¯†åº“å¤±è´¥

### å–æ¶ˆStarçŸ¥è¯†åº“ï¼ˆç‹¬ç«‹æ¥å£ï¼‰
ä¸“é—¨ç”¨äºå–æ¶ˆStarçŸ¥è¯†åº“ã€‚

```http
DELETE /api/knowledge/{kb_id}/star
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å–æ¶ˆStaræˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨æˆ–æœªæ‰¾åˆ°Starè®°å½•
- `401`: æœªæˆæƒè®¿é—®
- `500`: å–æ¶ˆStarçŸ¥è¯†åº“å¤±è´¥

### æ£€æŸ¥çŸ¥è¯†åº“StarçŠ¶æ€
æ£€æŸ¥æŒ‡å®šçŸ¥è¯†åº“æ˜¯å¦å·²è¢«å½“å‰ç”¨æˆ·Starã€‚

```http
GET /api/knowledge/{kb_id}/starred
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "starred": true
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: æ£€æŸ¥StarçŠ¶æ€å¤±è´¥

### æ›´æ–°çŸ¥è¯†åº“ä¿¡æ¯
ä¿®æ”¹çŸ¥è¯†åº“çš„åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€æè¿°ã€ç‰ˆæƒæ‰€æœ‰è€…ç­‰ï¼‰ã€‚

```http
PUT /api/knowledge/{kb_id}
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "æ›´æ–°åçš„çŸ¥è¯†åº“åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…"
}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `name` (å¯é€‰): çŸ¥è¯†åº“åç§°
- `description` (å¯é€‰): çŸ¥è¯†åº“æè¿°
- `copyright_owner` (å¯é€‰): ç‰ˆæƒæ‰€æœ‰è€…

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "kb123",
  "name": "æ›´æ–°åçš„çŸ¥è¯†åº“åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "uploader_id": "user123",
  "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
  "star_count": 5,
  "is_public": true,
  "is_pending": false,
  "created_at": "2025-11-22T00:00:00",
  "updated_at": "2025-11-22T01:00:00"
}
```

**é”™è¯¯å“åº”**:
- `400`: æ²¡æœ‰æä¾›è¦æ›´æ–°çš„å­—æ®µ
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™ä¿®æ”¹æ­¤çŸ¥è¯†åº“ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹ï¼‰
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: ä¿®æ”¹çŸ¥è¯†åº“å¤±è´¥

### æ·»åŠ çŸ¥è¯†åº“æ–‡ä»¶
å‘å·²å­˜åœ¨çš„çŸ¥è¯†åº“æ·»åŠ æ–°æ–‡ä»¶ã€‚

```http
POST /api/knowledge/{kb_id}/files
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `files` (å¿…å¡«): è¦æ·»åŠ çš„æ–‡ä»¶åˆ—è¡¨ï¼Œè‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ–‡ä»¶æ·»åŠ æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: è‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™å‘æ­¤çŸ¥è¯†åº“æ·»åŠ æ–‡ä»¶ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥æ·»åŠ ï¼‰
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: æ·»åŠ æ–‡ä»¶å¤±è´¥

### åˆ é™¤çŸ¥è¯†åº“æ–‡ä»¶
åˆ é™¤çŸ¥è¯†åº“ä¸­çš„æŒ‡å®šæ–‡ä»¶ã€‚

```http
DELETE /api/knowledge/{kb_id}/{file_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `file_id` (è·¯å¾„å‚æ•°): è¦åˆ é™¤çš„æ–‡ä»¶ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ–‡ä»¶åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™åˆ é™¤æ­¤çŸ¥è¯†åº“çš„æ–‡ä»¶ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥åˆ é™¤ï¼‰
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: åˆ é™¤æ–‡ä»¶å¤±è´¥

### ä¸‹è½½çŸ¥è¯†åº“å‹ç¼©åŒ…
ä¸‹è½½çŸ¥è¯†åº“çš„æ‰€æœ‰æ–‡ä»¶å‹ç¼©åŒ…ï¼ˆZIPæ ¼å¼ï¼‰ã€‚

```http
GET /api/knowledge/{kb_id}/download
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”**:
- è¿”å›ZIPæ–‡ä»¶æµï¼ŒContent-Type: `application/zip`

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: ä¸‹è½½å¤±è´¥

### ä¸‹è½½çŸ¥è¯†åº“å•ä¸ªæ–‡ä»¶
ä¸‹è½½çŸ¥è¯†åº“ä¸­çš„æŒ‡å®šæ–‡ä»¶ã€‚

```http
GET /api/knowledge/{kb_id}/file/{file_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `file_id` (è·¯å¾„å‚æ•°): æ–‡ä»¶ID

**å“åº”**:
- è¿”å›æ–‡ä»¶æµï¼ŒContent-Type: `application/octet-stream`

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™ä¸‹è½½æ­¤çŸ¥è¯†åº“ï¼ˆç§æœ‰çŸ¥è¯†åº“åªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥ä¸‹è½½ï¼‰
- `404`: çŸ¥è¯†åº“æˆ–æ–‡ä»¶ä¸å­˜åœ¨
- `500`: ä¸‹è½½æ–‡ä»¶å¤±è´¥

### åˆ é™¤çŸ¥è¯†åº“
åˆ é™¤æ•´ä¸ªçŸ¥è¯†åº“åŠå…¶æ‰€æœ‰æ–‡ä»¶ã€‚

```http
DELETE /api/knowledge/{kb_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "çŸ¥è¯†åº“åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™åˆ é™¤æ­¤çŸ¥è¯†åº“ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥åˆ é™¤ï¼‰
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: åˆ é™¤çŸ¥è¯†åº“å¤±è´¥

## äººè®¾å¡ç®¡ç†æ¥å£

### ä¸Šä¼ äººè®¾å¡
ä¸Šä¼ äººè®¾å¡æ–‡ä»¶ï¼Œæ”¯æŒå¤šä¸ªæ–‡ä»¶åŒæ—¶ä¸Šä¼ ã€‚

```http
POST /api/persona/upload
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
name: äººè®¾å¡åç§°
description: äººè®¾å¡æè¿°
copyright_owner: ç‰ˆæƒæ‰€æœ‰è€…ï¼ˆå¯é€‰ï¼‰
```

**å‚æ•°è¯´æ˜**:
- `files` (å¿…å¡«): äººè®¾å¡æ–‡ä»¶åˆ—è¡¨ï¼Œè‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `name` (å¿…å¡«): äººè®¾å¡åç§°
- `description` (å¿…å¡«): äººè®¾å¡æè¿°
- `copyright_owner` (å¯é€‰): ç‰ˆæƒæ‰€æœ‰è€…ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "pc123",
  "name": "æˆ‘çš„äººè®¾å¡",
  "description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•äººè®¾å¡",
  "uploader_id": "user123",
  "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
  "star_count": 0,
  "is_public": false,
  "is_pending": true,
  "created_at": "2025-11-22T00:00:00",
  "updated_at": "2025-11-22T00:00:00"
}
```

**é”™è¯¯å“åº”**:
- `400`: åç§°å’Œæè¿°ä¸èƒ½ä¸ºç©ºã€è‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `500`: ä¸Šä¼ äººè®¾å¡å¤±è´¥

### è·å–å…¬å¼€äººè®¾å¡åˆ—è¡¨
è·å–æ‰€æœ‰å·²å®¡æ ¸é€šè¿‡çš„å…¬å¼€äººè®¾å¡åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰å’Œæ’åºã€‚

```http
GET /api/persona/public?page=1&page_size=20&name=&uploader_id=&sort_by=created_at&sort_order=desc
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼ŒèŒƒå›´1-100ï¼Œé»˜è®¤ä¸º20
- `name` (å¯é€‰): æŒ‰åç§°æœç´¢ï¼Œæ”¯æŒæ¨¡ç³ŠåŒ¹é…
- `uploader_id` (å¯é€‰): æŒ‰ä¸Šä¼ è€…IDç­›é€‰
- `sort_by` (å¯é€‰): æ’åºå­—æ®µï¼Œå¯é€‰å€¼ï¼š`created_at`ã€`updated_at`ã€`star_count`ï¼Œé»˜è®¤ä¸º `created_at`
- `sort_order` (å¯é€‰): æ’åºé¡ºåºï¼Œå¯é€‰å€¼ï¼š`asc`ã€`desc`ï¼Œé»˜è®¤ä¸º `desc`

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [
    {
      "id": "pc123",
      "name": "å…¬å¼€äººè®¾å¡",
      "description": "è¿™æ˜¯ä¸€ä¸ªå…¬å¼€çš„äººè®¾å¡",
      "uploader_id": "user123",
      "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
      "star_count": 8,
      "is_public": true,
      "is_pending": false,
      "created_at": "2025-11-22T00:00:00",
      "updated_at": "2025-11-22T00:00:00"
    }
  ],
  "total": 50,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `400`: æŸ¥è¯¢å‚æ•°æ— æ•ˆï¼ˆå¦‚page_sizeè¶…å‡ºèŒƒå›´ï¼‰
- `500`: è·å–å…¬å¼€äººè®¾å¡å¤±è´¥

### è·å–äººè®¾å¡å†…å®¹
è·å–æŒ‡å®šäººè®¾å¡çš„è¯¦ç»†å†…å®¹ã€‚

```http
GET /api/persona/{pc_id}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "content": "äººè®¾å¡å†…å®¹...",
  "metadata": {
    "file_count": 1,
    "total_size": 512
  }
}
```

**é”™è¯¯å“åº”**:
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: è·å–äººè®¾å¡å†…å®¹å¤±è´¥

### è·å–ç”¨æˆ·çš„äººè®¾å¡åˆ—è¡¨
è·å–æŒ‡å®šç”¨æˆ·ä¸Šä¼ çš„æ‰€æœ‰äººè®¾å¡ã€‚

```http
GET /api/persona/user/{user_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `user_id` (è·¯å¾„å‚æ•°): ç”¨æˆ·ID

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "pc123",
    "name": "æˆ‘çš„äººè®¾å¡",
    "description": "ç”¨æˆ·äººè®¾å¡æè¿°",
    "uploader_id": "user123",
    "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
    "star_count": 3,
    "is_public": false,
    "is_pending": true,
    "created_at": "2025-11-22T00:00:00",
    "updated_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰æƒé™æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„ä¸Šä¼ è®°å½•
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·äººè®¾å¡å¤±è´¥

### æ›´æ–°äººè®¾å¡ä¿¡æ¯
æ›´æ–°äººè®¾å¡å…ƒä¿¡æ¯ï¼Œä»…é™ä¸Šä¼ è€…ã€ç®¡ç†å‘˜æˆ–å®¡æ ¸å‘˜ã€‚

```http
PUT /api/persona/{pc_id}
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "æ–°çš„åç§°",
  "description": "æ–°çš„æè¿°",
  "copyright_owner": "æ–°çš„ç‰ˆæƒæ‰€æœ‰è€…"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: æ›´æ–°å¤±è´¥

### æ·»åŠ äººè®¾å¡æ–‡ä»¶
ä¸ºäººè®¾å¡è¿½åŠ æ–‡ä»¶ã€‚

```http
POST /api/persona/{pc_id}/files
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
```

**é”™è¯¯å“åº”**:
- `400`: æœªä¸Šä¼ æ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: ä¸Šä¼ å¤±è´¥

### åˆ é™¤äººè®¾å¡æ–‡ä»¶

```http
DELETE /api/persona/{pc_id}/{file_id}
Authorization: Bearer {token}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: æ–‡ä»¶æˆ–äººè®¾å¡ä¸å­˜åœ¨
- `500`: åˆ é™¤å¤±è´¥

### ä¸‹è½½äººè®¾å¡å…¨éƒ¨æ–‡ä»¶

```http
GET /api/persona/{pc_id}/download
Authorization: Bearer {token}
```

**è¯´æ˜**: ç§æœ‰äººè®¾å¡ä»…ä¸Šä¼ è€…æˆ–ç®¡ç†å‘˜å¯ä¸‹è½½ã€‚

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ— æƒä¸‹è½½
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: æ‰“åŒ…å¤±è´¥

### ä¸‹è½½å•ä¸ªäººè®¾å¡æ–‡ä»¶

```http
GET /api/persona/{pc_id}/file/{file_id}
Authorization: Bearer {token}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ— æƒä¸‹è½½
- `404`: æ–‡ä»¶ä¸å­˜åœ¨
- `500`: ä¸‹è½½å¤±è´¥

### åˆ é™¤äººè®¾å¡
åˆ é™¤æ•´ä¸ªäººè®¾å¡åŠå…¶æ–‡ä»¶ã€‚

```http
DELETE /api/persona/{pc_id}
Authorization: Bearer {token}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æƒé™ä¸è¶³
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: åˆ é™¤å¤±è´¥

### Star/å–æ¶ˆStaräººè®¾å¡
å¯¹äººè®¾å¡è¿›è¡ŒStaræˆ–å–æ¶ˆStaræ“ä½œï¼Œæ¥å£ä¼šæ ¹æ®å½“å‰çŠ¶æ€è‡ªåŠ¨åˆ‡æ¢ã€‚

```http
POST /api/persona/{pc_id}/star
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "StaræˆåŠŸ"
}
```

æˆ–

```json
{
  "message": "å–æ¶ˆStaræˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `401`: æœªæˆæƒè®¿é—®
- `500`: Staräººè®¾å¡å¤±è´¥

### å–æ¶ˆStaräººè®¾å¡ï¼ˆç‹¬ç«‹æ¥å£ï¼‰
ä¸“é—¨ç”¨äºå–æ¶ˆStaräººè®¾å¡ã€‚

```http
DELETE /api/persona/{pc_id}/star
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å–æ¶ˆStaræˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `404`: äººè®¾å¡ä¸å­˜åœ¨æˆ–æœªæ‰¾åˆ°Starè®°å½•
- `401`: æœªæˆæƒè®¿é—®
- `500`: å–æ¶ˆStaräººè®¾å¡å¤±è´¥

### æ£€æŸ¥äººè®¾å¡StarçŠ¶æ€
æ£€æŸ¥æŒ‡å®šäººè®¾å¡æ˜¯å¦å·²è¢«å½“å‰ç”¨æˆ·Starã€‚

```http
GET /api/persona/{pc_id}/starred
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "starred": true
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: æ£€æŸ¥StarçŠ¶æ€å¤±è´¥

### æ›´æ–°äººè®¾å¡ä¿¡æ¯
ä¿®æ”¹äººè®¾å¡çš„åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€æè¿°ã€ç‰ˆæƒæ‰€æœ‰è€…ç­‰ï¼‰ã€‚

```http
PUT /api/persona/{pc_id}
Authorization: Bearer {token}
Content-Type: application/x-www-form-urlencoded

name=æ›´æ–°åçš„äººè®¾å¡åç§°&description=æ›´æ–°åçš„æè¿°&copyright_owner=ç‰ˆæƒæ‰€æœ‰è€…
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID
- `name` (å¿…å¡«): äººè®¾å¡åç§°
- `description` (å¿…å¡«): äººè®¾å¡æè¿°
- `copyright_owner` (å¯é€‰): ç‰ˆæƒæ‰€æœ‰è€…

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "pc123",
  "name": "æ›´æ–°åçš„äººè®¾å¡åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "uploader_id": "user123",
  "copyright_owner": "ç‰ˆæƒæ‰€æœ‰è€…",
  "star_count": 3,
  "is_public": true,
  "is_pending": false,
  "created_at": "2025-11-22T00:00:00",
  "updated_at": "2025-11-22T01:00:00"
}
```

**é”™è¯¯å“åº”**:
- `400`: åç§°å’Œæè¿°ä¸èƒ½ä¸ºç©º
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™ä¿®æ”¹æ­¤äººè®¾å¡ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹ï¼‰
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: ä¿®æ”¹äººè®¾å¡å¤±è´¥

### æ·»åŠ äººè®¾å¡æ–‡ä»¶
å‘å·²å­˜åœ¨çš„äººè®¾å¡æ·»åŠ æ–°æ–‡ä»¶ã€‚

```http
POST /api/persona/{pc_id}/files
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [æ–‡ä»¶1, æ–‡ä»¶2, ...]
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID
- `files` (å¿…å¡«): è¦æ·»åŠ çš„æ–‡ä»¶åˆ—è¡¨ï¼Œè‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ–‡ä»¶æ·»åŠ æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: è‡³å°‘éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™å‘æ­¤äººè®¾å¡æ·»åŠ æ–‡ä»¶ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥æ·»åŠ ï¼‰
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: æ·»åŠ æ–‡ä»¶å¤±è´¥

### åˆ é™¤äººè®¾å¡æ–‡ä»¶
åˆ é™¤äººè®¾å¡ä¸­çš„æŒ‡å®šæ–‡ä»¶ã€‚

```http
DELETE /api/persona/{pc_id}/{file_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID
- `file_id` (è·¯å¾„å‚æ•°): è¦åˆ é™¤çš„æ–‡ä»¶ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ–‡ä»¶åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™ä»æ­¤äººè®¾å¡åˆ é™¤æ–‡ä»¶ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥åˆ é™¤ï¼‰
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: åˆ é™¤æ–‡ä»¶å¤±è´¥

### ä¸‹è½½äººè®¾å¡å‹ç¼©åŒ…
ä¸‹è½½äººè®¾å¡çš„æ‰€æœ‰æ–‡ä»¶å‹ç¼©åŒ…ï¼ˆZIPæ ¼å¼ï¼‰ã€‚

```http
GET /api/persona/{pc_id}/download
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”**:
- è¿”å›ZIPæ–‡ä»¶æµï¼ŒContent-Type: `application/zip`

**é”™è¯¯å“åº”**:
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: ä¸‹è½½å¤±è´¥

### ä¸‹è½½äººè®¾å¡å•ä¸ªæ–‡ä»¶
ä¸‹è½½äººè®¾å¡ä¸­çš„æŒ‡å®šæ–‡ä»¶ã€‚

```http
GET /api/persona/{pc_id}/file/{file_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID
- `file_id` (è·¯å¾„å‚æ•°): æ–‡ä»¶ID

**å“åº”**:
- è¿”å›æ–‡ä»¶æµï¼ŒContent-Type: `application/octet-stream`

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™ä¸‹è½½æ­¤äººè®¾å¡ï¼ˆç§æœ‰äººè®¾å¡åªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥ä¸‹è½½ï¼‰
- `404`: äººè®¾å¡æˆ–æ–‡ä»¶ä¸å­˜åœ¨
- `500`: ä¸‹è½½æ–‡ä»¶å¤±è´¥

### åˆ é™¤äººè®¾å¡
åˆ é™¤æ•´ä¸ªäººè®¾å¡åŠå…¶æ‰€æœ‰æ–‡ä»¶ã€‚

```http
DELETE /api/persona/{pc_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "äººè®¾å¡åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `403`: æ²¡æœ‰æƒé™åˆ é™¤æ­¤äººè®¾å¡ï¼ˆåªæœ‰ä¸Šä¼ è€…å’Œç®¡ç†å‘˜å¯ä»¥åˆ é™¤ï¼‰
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: åˆ é™¤äººè®¾å¡å¤±è´¥

## ç”¨æˆ·Starè®°å½•æ¥å£

### è·å–ç”¨æˆ·Starçš„çŸ¥è¯†åº“å’Œäººè®¾å¡
è·å–å½“å‰ç”¨æˆ·Starçš„æ‰€æœ‰å…¬å¼€çŸ¥è¯†åº“å’Œäººè®¾å¡ã€‚

```http
GET /api/user/stars?includeDetails=false
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `includeDetails` (å¯é€‰): æ˜¯å¦åŒ…å«å®Œæ•´è¯¦æƒ…ï¼Œé»˜è®¤ä¸º `false`

**å“åº”ç¤ºä¾‹**ï¼ˆincludeDetails=falseï¼‰:
```json
[
  {
    "id": "star123",
    "type": "knowledge",
    "target_id": "kb123",
    "name": "æˆ‘çš„çŸ¥è¯†åº“",
    "description": "çŸ¥è¯†åº“æè¿°",
    "star_count": 10,
    "created_at": "2025-11-22T00:00:00"
  },
  {
    "id": "star456",
    "type": "persona",
    "target_id": "pc123",
    "name": "æˆ‘çš„äººè®¾å¡",
    "description": "äººè®¾å¡æè¿°",
    "star_count": 5,
    "created_at": "2025-11-22T00:00:00"
  }
]
```

**å“åº”ç¤ºä¾‹**ï¼ˆincludeDetails=trueï¼‰:
è¿”å›Starè®°å½•çš„åŒæ—¶åŒ…å«çŸ¥è¯†åº“/äººè®¾å¡çš„å®Œæ•´ä¿¡æ¯ï¼ˆåŒ…æ‹¬æ–‡ä»¶åˆ—è¡¨ã€å…ƒæ•°æ®ç­‰ï¼‰ã€‚

**é”™è¯¯å“åº”**:
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·Starè®°å½•å¤±è´¥

## å®¡æ ¸ç®¡ç†æ¥å£

### è·å–å¾…å®¡æ ¸çŸ¥è¯†åº“
è·å–æ‰€æœ‰å¾…å®¡æ ¸çš„çŸ¥è¯†åº“åˆ—è¡¨ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
GET /api/review/knowledge/pending
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "kb123",
    "name": "å¾…å®¡æ ¸çŸ¥è¯†åº“",
    "description": "å¾…å®¡æ ¸çš„çŸ¥è¯†åº“",
    "uploader_id": "user123",
    "copyright_owner": "ä¸Šä¼ è€…",
    "star_count": 0,
    "is_public": false,
    "is_pending": true,
    "created_at": "2025-11-22T00:00:00",
    "updated_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–å¾…å®¡æ ¸çŸ¥è¯†åº“å¤±è´¥

### è·å–å¾…å®¡æ ¸äººè®¾å¡
è·å–æ‰€æœ‰å¾…å®¡æ ¸çš„äººè®¾å¡åˆ—è¡¨ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
GET /api/review/persona/pending
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "pc123",
    "name": "å¾…å®¡æ ¸äººè®¾å¡",
    "description": "å¾…å®¡æ ¸çš„äººè®¾å¡",
    "uploader_id": "user123",
    "copyright_owner": "ä¸Šä¼ è€…",
    "star_count": 0,
    "is_public": false,
    "is_pending": true,
    "created_at": "2025-11-22T00:00:00",
    "updated_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–å¾…å®¡æ ¸äººè®¾å¡å¤±è´¥

### å®¡æ ¸é€šè¿‡çŸ¥è¯†åº“
å®¡æ ¸é€šè¿‡æŒ‡å®šçš„çŸ¥è¯†åº“ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
POST /api/review/knowledge/{kb_id}/approve
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å®¡æ ¸é€šè¿‡"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: å®¡æ ¸çŸ¥è¯†åº“å¤±è´¥

### å®¡æ ¸æ‹’ç»çŸ¥è¯†åº“
å®¡æ ¸æ‹’ç»æŒ‡å®šçš„çŸ¥è¯†åº“ï¼Œå¹¶å‘é€æ‹’ç»é€šçŸ¥ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
POST /api/review/knowledge/{kb_id}/reject
Authorization: Bearer {token}
Content-Type: application/json

{
  "reason": "æ‹’ç»åŸå› "
}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID
- `reason` (è¯·æ±‚ä½“): æ‹’ç»åŸå› 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å®¡æ ¸æ‹’ç»ï¼Œå·²å‘é€é€šçŸ¥"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: å®¡æ ¸çŸ¥è¯†åº“å¤±è´¥

### å®¡æ ¸é€šè¿‡äººè®¾å¡
å®¡æ ¸é€šè¿‡æŒ‡å®šçš„äººè®¾å¡ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
POST /api/review/persona/{pc_id}/approve
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å®¡æ ¸é€šè¿‡"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: å®¡æ ¸äººè®¾å¡å¤±è´¥

### å®¡æ ¸æ‹’ç»äººè®¾å¡
å®¡æ ¸æ‹’ç»æŒ‡å®šçš„äººè®¾å¡ï¼Œå¹¶å‘é€æ‹’ç»é€šçŸ¥ï¼ˆéœ€è¦adminæˆ–moderatoræƒé™ï¼‰ã€‚

```http
POST /api/review/persona/{pc_id}/reject
Authorization: Bearer {token}
Content-Type: application/json

{
  "reason": "æ‹’ç»åŸå› "
}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID
- `reason` (è¯·æ±‚ä½“): æ‹’ç»åŸå› 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å®¡æ ¸æ‹’ç»ï¼Œå·²å‘é€é€šçŸ¥"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰å®¡æ ¸æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: å®¡æ ¸äººè®¾å¡å¤±è´¥

## æ¶ˆæ¯ç®¡ç†æ¥å£

### å‘é€ç«™å†…å…¬å‘Š/æ¶ˆæ¯
å‘æŒ‡å®šç”¨æˆ·å‘é€ç«™å†…å…¬å‘Šæˆ–ç§ä¿¡ï¼ˆå¸¸ç”¨äºå®¡æ ¸é€šçŸ¥ï¼‰ã€‚æ–°å¢åŸç”Ÿç¾¤å‘èƒ½åŠ›ï¼Œå¯ä¸€æ¬¡æ€§å‘å¤šä½ç”¨æˆ·æˆ–å…¨ä½“ç”¨æˆ·æ¨é€å…¬å‘Šã€‚

```http
POST /api/messages/send
Authorization: Bearer {token}
Content-Type: application/json

{
  "recipient_id": "user456",
  "title": "å®¡æ ¸ç»“æœé€šçŸ¥",
  "content": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯",
  "message_type": "direct"
}
```

**å…¬å‘Šç¾¤å‘ç¤ºä¾‹**:

```json
{
  "title": "ç³»ç»Ÿç»´æŠ¤å…¬å‘Š",
  "content": "ä»Šæ™š 23:00-23:30 å°†è¿›è¡Œç»´æŠ¤ï¼Œè¯·æå‰ä¿å­˜è¿›åº¦ã€‚",
  "message_type": "announcement",
  "broadcast_scope": "all_users"
}
```

**å‚æ•°è¯´æ˜**:
- `title` (å¿…å¡«): æ¶ˆæ¯æ ‡é¢˜ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯åˆ—è¡¨ä¸­å±•ç¤º
- `content` (å¿…å¡«): æ¶ˆæ¯å†…å®¹
- `message_type` (å¯é€‰): `direct`ï¼ˆé»˜è®¤ï¼‰æˆ– `announcement`
- `recipient_id` (å¯é€‰): å•ä¸ªæ¥æ”¶è€…ç”¨æˆ·IDï¼ˆ`direct`æ—¶å¿…å¡«ï¼‰
- `recipient_ids` (å¯é€‰): æ‰¹é‡æ¥æ”¶è€…IDåˆ—è¡¨
- `broadcast_scope` (å¯é€‰): å½“å‰æ”¯æŒ `all_users`ï¼Œä¸€æ¬¡å‘æ‰€æœ‰æ´»è·ƒç”¨æˆ·æ¨é€
- `announcement` ç±»å‹è‡³å°‘éœ€è¦ `recipient_ids`ã€`recipient_id` ä¹‹ä¸€æˆ– `broadcast_scope=all_users`

**å“åº”ç¤ºä¾‹**:
```json
{
  "message_ids": ["msg123", "msg124"],
  "count": 2,
  "status": "sent"
}
```

**é”™è¯¯å“åº”**:
- `400`: æ¶ˆæ¯å†…å®¹/æ ‡é¢˜ä¸èƒ½ä¸ºç©ºã€ç¼ºå°‘æ¥æ”¶è€…
- `404`: æ¥æ”¶è€…ä¸å­˜åœ¨
- `401`: æœªæˆæƒè®¿é—®
- `500`: å‘é€æ¶ˆæ¯å¤±è´¥

### è·å–æ¶ˆæ¯åˆ—è¡¨
è·å–å½“å‰ç”¨æˆ·çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œå¯æŒ‡å®šä¸ç‰¹å®šç”¨æˆ·çš„å¯¹è¯ã€‚

```http
GET /api/messages?other_user_id=user456&limit=50&offset=0
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `other_user_id` (å¯é€‰): æŒ‡å®šå¯¹è¯ç”¨æˆ·çš„IDï¼Œä¸æŒ‡å®šåˆ™è·å–æ‰€æœ‰æ¶ˆæ¯
- `limit` (å¯é€‰): è¿”å›æ¶ˆæ¯æ•°é‡é™åˆ¶ï¼Œé»˜è®¤50ï¼ŒèŒƒå›´1-100
- `offset` (å¯é€‰): åç§»é‡ï¼Œé»˜è®¤0

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "msg123",
    "sender_id": "user456",
    "recipient_id": "user789",
    "title": "å®¡æ ¸ç»“æœé€šçŸ¥",
    "content": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯",
    "message_type": "direct",
    "broadcast_scope": null,
    "is_read": false,
    "created_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `400`: limitå¿…é¡»åœ¨1-100ä¹‹é—´ã€offsetä¸èƒ½ä¸ºè´Ÿæ•°
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–æ¶ˆæ¯åˆ—è¡¨å¤±è´¥

### æ ‡è®°æ¶ˆæ¯ä¸ºå·²è¯»
å°†æŒ‡å®šæ¶ˆæ¯æ ‡è®°ä¸ºå·²è¯»çŠ¶æ€ã€‚

```http
POST /api/messages/{message_id}/read
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `message_id` (è·¯å¾„å‚æ•°): æ¶ˆæ¯ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "success",
  "message": "æ¶ˆæ¯å·²æ ‡è®°ä¸ºå·²è¯»"
}
```

**é”™è¯¯å“åº”**:
- `404`: æ¶ˆæ¯ä¸å­˜åœ¨
- `403`: æ²¡æœ‰æƒé™æ ‡è®°æ­¤æ¶ˆæ¯ä¸ºå·²è¯»ï¼ˆéæ¥æ”¶è€…ï¼‰
- `401`: æœªæˆæƒè®¿é—®
- `500`: æ ‡è®°æ¶ˆæ¯å·²è¯»å¤±è´¥

## ç®¡ç†å‘˜æ¥å£ï¼ˆéœ€è¦adminæƒé™ï¼‰

### è·å–å¹¿æ’­æ¶ˆæ¯ç»Ÿè®¡
è·å–ç³»ç»Ÿå¹¿æ’­æ¶ˆæ¯çš„ç»Ÿè®¡æ•°æ®ã€‚

```http
GET /api/admin/broadcast-messages
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "total_broadcasts": 10,
  "total_recipients": 500,
  "recent_broadcasts": [...]
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥

### è·å–ç³»ç»Ÿç»Ÿè®¡æ•°æ®
è·å–ç³»ç»Ÿçš„æ•´ä½“ç»Ÿè®¡æ•°æ®ã€‚

```http
GET /api/admin/stats
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "total_users": 100,
  "total_knowledge_bases": 50,
  "total_persona_cards": 30,
  "pending_reviews": 5
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥

### è·å–æœ€è¿‘æ³¨å†Œç”¨æˆ·
è·å–æœ€è¿‘æ³¨å†Œçš„ç”¨æˆ·åˆ—è¡¨ã€‚

```http
GET /api/admin/recent-users?limit=10
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `limit` (å¯é€‰): è¿”å›æ•°é‡é™åˆ¶ï¼Œé»˜è®¤10

**å“åº”ç¤ºä¾‹**:
```json
[
  {
    "id": "user123",
    "username": "newuser",
    "email": "user@example.com",
    "created_at": "2025-11-22T00:00:00"
  }
]
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥

### è·å–ç”¨æˆ·åˆ—è¡¨
è·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œæœç´¢ã€‚

```http
GET /api/admin/users?page=1&page_size=20&search=
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
- `search` (å¯é€‰): æœç´¢å…³é”®è¯ï¼ˆç”¨æˆ·åæˆ–é‚®ç®±ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [...],
  "total": 100,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥

### æ›´æ–°ç”¨æˆ·è§’è‰²
æ›´æ–°æŒ‡å®šç”¨æˆ·çš„è§’è‰²ã€‚

```http
PUT /api/admin/users/{user_id}/role
Authorization: Bearer {token}
Content-Type: application/json

{
  "role": "moderator"
}
```

**å‚æ•°è¯´æ˜**:
- `user_id` (è·¯å¾„å‚æ•°): ç”¨æˆ·ID
- `role` (è¯·æ±‚ä½“): æ–°è§’è‰²ï¼ˆuserã€moderatorã€adminï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç”¨æˆ·è§’è‰²æ›´æ–°æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `400`: æ— æ•ˆçš„è§’è‰²
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: ç”¨æˆ·ä¸å­˜åœ¨
- `500`: æ›´æ–°ç”¨æˆ·è§’è‰²å¤±è´¥

### åˆ é™¤ç”¨æˆ·
åˆ é™¤æŒ‡å®šç”¨æˆ·ã€‚

```http
DELETE /api/admin/users/{user_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `user_id` (è·¯å¾„å‚æ•°): ç”¨æˆ·ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç”¨æˆ·åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: ç”¨æˆ·ä¸å­˜åœ¨
- `500`: åˆ é™¤ç”¨æˆ·å¤±è´¥

### åˆ›å»ºæ–°ç”¨æˆ·
ç®¡ç†å‘˜åˆ›å»ºæ–°ç”¨æˆ·ã€‚

```http
POST /api/admin/users
Authorization: Bearer {token}
Content-Type: application/json

{
  "username": "newuser",
  "password": "password123",
  "email": "user@example.com",
  "role": "user"
}
```

**å‚æ•°è¯´æ˜**:
- `username` (å¿…å¡«): ç”¨æˆ·å
- `password` (å¿…å¡«): å¯†ç 
- `email` (å¿…å¡«): é‚®ç®±åœ°å€
- `role` (å¯é€‰): è§’è‰²ï¼Œé»˜è®¤ä¸ºuser

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": "user123",
  "username": "newuser",
  "email": "user@example.com",
  "role": "user"
}
```

**é”™è¯¯å“åº”**:
- `400`: å‚æ•°é”™è¯¯ã€ç”¨æˆ·åæˆ–é‚®ç®±å·²å­˜åœ¨
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `500`: åˆ›å»ºç”¨æˆ·å¤±è´¥

### è·å–æ‰€æœ‰çŸ¥è¯†åº“ï¼ˆç®¡ç†å‘˜ï¼‰
è·å–æ‰€æœ‰çŸ¥è¯†åº“ï¼ŒåŒ…æ‹¬å¾…å®¡æ ¸å’Œå·²æ‹’ç»çš„ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
GET /api/admin/knowledge/all?page=1&page_size=20
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [...],
  "total": 100,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥

### è·å–æ‰€æœ‰äººè®¾å¡ï¼ˆç®¡ç†å‘˜ï¼‰
è·å–æ‰€æœ‰äººè®¾å¡ï¼ŒåŒ…æ‹¬å¾…å®¡æ ¸å’Œå·²æ‹’ç»çš„ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
GET /api/admin/persona/all?page=1&page_size=20
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [...],
  "total": 50,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–äººè®¾å¡åˆ—è¡¨å¤±è´¥

### æ¢å¤çŸ¥è¯†åº“å®¡æ ¸çŠ¶æ€
å°†çŸ¥è¯†åº“çš„å®¡æ ¸çŠ¶æ€æ¢å¤ä¸ºå¾…å®¡æ ¸ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
POST /api/admin/knowledge/{kb_id}/revert
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `kb_id` (è·¯å¾„å‚æ•°): çŸ¥è¯†åº“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "çŸ¥è¯†åº“å®¡æ ¸çŠ¶æ€å·²æ¢å¤"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `500`: æ¢å¤å®¡æ ¸çŠ¶æ€å¤±è´¥

### æ¢å¤äººè®¾å¡å®¡æ ¸çŠ¶æ€
å°†äººè®¾å¡çš„å®¡æ ¸çŠ¶æ€æ¢å¤ä¸ºå¾…å®¡æ ¸ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
POST /api/admin/persona/{pc_id}/revert
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `pc_id` (è·¯å¾„å‚æ•°): äººè®¾å¡ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "äººè®¾å¡å®¡æ ¸çŠ¶æ€å·²æ¢å¤"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: äººè®¾å¡ä¸å­˜åœ¨
- `500`: æ¢å¤å®¡æ ¸çŠ¶æ€å¤±è´¥

### è·å–ä¸Šä¼ å†å²è®°å½•
è·å–æ‰€æœ‰ä¸Šä¼ å†å²è®°å½•ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
GET /api/admin/upload-history?page=1&page_size=20
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜**:
- `page` (å¯é€‰): é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤ä¸º1
- `page_size` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

**å“åº”ç¤ºä¾‹**:
```json
{
  "items": [...],
  "total": 200,
  "page": 1,
  "page_size": 20
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ä¸Šä¼ å†å²å¤±è´¥

### è·å–ä¸Šä¼ ç»Ÿè®¡æ•°æ®
è·å–ä¸Šä¼ ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
GET /api/admin/upload-stats
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "total_uploads": 200,
  "pending_uploads": 10,
  "approved_uploads": 150,
  "rejected_uploads": 40
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥

### åˆ é™¤ä¸Šä¼ è®°å½•
åˆ é™¤æŒ‡å®šçš„ä¸Šä¼ è®°å½•ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
DELETE /api/admin/uploads/{upload_id}
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `upload_id` (è·¯å¾„å‚æ•°): ä¸Šä¼ è®°å½•ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ä¸Šä¼ è®°å½•åˆ é™¤æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: ä¸Šä¼ è®°å½•ä¸å­˜åœ¨
- `500`: åˆ é™¤ä¸Šä¼ è®°å½•å¤±è´¥

### é‡æ–°å¤„ç†ä¸Šä¼ 
é‡æ–°å¤„ç†æŒ‡å®šçš„ä¸Šä¼ è®°å½•ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚

```http
POST /api/admin/uploads/{upload_id}/reprocess
Authorization: Bearer {token}
```

**å‚æ•°è¯´æ˜**:
- `upload_id` (è·¯å¾„å‚æ•°): ä¸Šä¼ è®°å½•ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ä¸Šä¼ è®°å½•å·²é‡æ–°å¤„ç†"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰ç®¡ç†å‘˜æƒé™
- `404`: ä¸Šä¼ è®°å½•ä¸å­˜åœ¨
- `500`: é‡æ–°å¤„ç†å¤±è´¥

## é‚®ä»¶æœåŠ¡æ¥å£

### å‘é€é‚®ä»¶ï¼ˆæœªå®ç°ï¼‰
å‘é€é‚®ä»¶åˆ°æŒ‡å®šé‚®ç®±ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚
**çŠ¶æ€**ï¼šæœªå®ç°ï¼Œæ–‡æ¡£ä»…æä¾›è§„åˆ’ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯è°ƒç”¨å°†è¿”å› `404` æˆ– `501`ã€‚

```http
POST /api/email/send
Authorization: Bearer {token}
Content-Type: application/json

{
  "receiver": "user@example.com",
  "subject": "æµ‹è¯•é‚®ä»¶",
  "content": "è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶"
}
```

**è¯·æ±‚å‚æ•°**:

| åç§° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `receiver` | string | æ˜¯ | æ¥æ”¶è€…é‚®ç®±åœ°å€ |
| `subject` | string | æ˜¯ | é‚®ä»¶ä¸»é¢˜ |
| `content` | string | æ˜¯ | é‚®ä»¶æ­£æ–‡ |

**é¢„æœŸå“åº”**:
```json
{
  "message": "é‚®ä»¶å‘é€æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: é‚®ä»¶å‘é€å¤±è´¥

### è·å–é‚®ç®±é…ç½®ï¼ˆæœªå®ç°ï¼‰
è·å–å½“å‰çš„é‚®ç®±æœåŠ¡é…ç½®ä¿¡æ¯ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚
**çŠ¶æ€**ï¼šæœªå®ç°ï¼Œæ–‡æ¡£ä»…æä¾›è§„åˆ’ä¿¡æ¯ï¼Œæš‚æœªè¿”å›çœŸå®é…ç½®ã€‚

```http
GET /api/email/config
Authorization: Bearer {token}
```

**é¢„æœŸå“åº”**:
```json
{
  "mail_host": "smtp.example.com",
  "mail_user": "sender@example.com",
  "mail_port": 587,
  "mail_pwd": "******"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: è·å–é…ç½®å¤±è´¥

### æ›´æ–°é‚®ç®±é…ç½®ï¼ˆæœªå®ç°ï¼‰
æ›´æ–°é‚®ç®±æœåŠ¡é…ç½®ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ã€‚
**çŠ¶æ€**ï¼šæœªå®ç°ï¼Œæš‚ä¸æ”¯æŒåŠ¨æ€æ›´æ–°ã€‚

```http
PUT /api/email/config
Authorization: Bearer {token}
Content-Type: application/json

{
  "mail_host": "smtp.newserver.com",
  "mail_user": "newsender@example.com",
  "mail_port": 587,
  "mail_pwd": "newpassword"
}
```

**è¯·æ±‚å‚æ•°**:

| åç§° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `mail_host` | string | æ˜¯ | SMTP æœåŠ¡å™¨åœ°å€ |
| `mail_user` | string | æ˜¯ | é‚®ç®±ç”¨æˆ·å |
| `mail_port` | integer | æ˜¯ | SMTP ç«¯å£ |
| `mail_pwd` | string | æ˜¯ | é‚®ç®±å¯†ç  |

**é¢„æœŸå“åº”**:
```json
{
  "message": "é‚®ç®±é…ç½®æ›´æ–°æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**:
- `403`: æ²¡æœ‰æƒé™
- `401`: æœªæˆæƒè®¿é—®
- `500`: æ›´æ–°é…ç½®å¤±è´¥

## é”™è¯¯å“åº”æ ¼å¼

æ‰€æœ‰é”™è¯¯å“åº”éƒ½éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š

```json
{
  "detail": "é”™è¯¯æè¿°ä¿¡æ¯"
}
```

## æƒé™è¦æ±‚è¯´æ˜

### è§’è‰²æƒé™
- **user**: æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥ä¸Šä¼ ã€æŸ¥çœ‹è‡ªå·±çš„å†…å®¹
- **moderator**: å®¡æ ¸å‘˜ï¼Œå¯ä»¥å®¡æ ¸å†…å®¹
- **admin**: ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™

### æ¥å£æƒé™è¦æ±‚
- **å…¬å¼€æ¥å£**: ä¸éœ€è¦è®¤è¯ï¼Œå¦‚ `/api/knowledge/public`
- **ç”¨æˆ·è®¤è¯**: éœ€è¦ç™»å½•ï¼Œå¦‚ `/api/users/me`
- **å®¡æ ¸æƒé™**: éœ€è¦ moderator æˆ– admin è§’è‰²
- **ç®¡ç†æƒé™**: éœ€è¦ admin è§’è‰²

## å¸¸è§é”™è¯¯ç 

| çŠ¶æ€ç  | æè¿° |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒè®¿é—® |
| 403 | ç¦æ­¢è®¿é—®ï¼ˆæƒé™ä¸è¶³ï¼‰ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 409 | èµ„æºå†²çªï¼ˆå¦‚é‡å¤Starï¼‰ |
| 422 | è¯·æ±‚éªŒè¯å¤±è´¥ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

## é™æµè¯´æ˜

API å®æ–½äº†è¯·æ±‚é™æµï¼Œæ¯ä¸ª IP åœ°å€æ¯åˆ†é’Ÿæœ€å¤šå¯ä»¥è¯·æ±‚ 100 æ¬¡ã€‚

## ç‰ˆæœ¬æ§åˆ¶

API ç‰ˆæœ¬é€šè¿‡ URL è·¯å¾„è¿›è¡Œæ§åˆ¶ï¼Œå½“å‰ç‰ˆæœ¬ä¸º v1ã€‚æœªæ¥ç‰ˆæœ¬å°†ä¿æŒå‘åå…¼å®¹æ€§ã€‚

## å¼€å‘å·¥å…·

### åœ¨çº¿æ–‡æ¡£

å¯åŠ¨æœåŠ¡å™¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®äº¤äº’å¼ API æ–‡æ¡£ï¼š

- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

### æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œä½äº `tests` ç›®å½•ã€‚è¿è¡Œæµ‹è¯•ï¼š

```bash
pytest tests/
```

## æ•°æ®æ¨¡å‹

### ç”¨æˆ·æ¨¡å‹

```json
{
  "id": "string",
  "username": "string",
  "email": "string",
  "role": "user|moderator|admin",
  "created_at": "datetime"
}
```

### çŸ¥è¯†åº“æ¨¡å‹

```json
{
  "id": "string",
  "name": "string",
  "description": "string",
  "uploader_id": "string",
  "copyright_owner": "string|null",
  "star_count": "integer",
  "is_public": "boolean",
  "is_pending": "boolean",
  "created_at": "datetime",
  "updated_at": "datetime"
}
```

### äººè®¾å¡æ¨¡å‹

```json
{
  "id": "string",
  "name": "string",
  "description": "string",
  "uploader_id": "string",
  "copyright_owner": "string|null",
  "star_count": "integer",
  "is_public": "boolean",
  "is_pending": "boolean",
  "created_at": "datetime",
  "updated_at": "datetime"
}
```

### æ¶ˆæ¯æ¨¡å‹

```json
{
  "id": "string",
  "sender_id": "string",
  "recipient_id": "string",
  "title": "string",
  "content": "string",
  "is_read": "boolean",
  "created_at": "datetime"
}
```

### Star æ¨¡å‹

```json
{
  "id": "string",
  "user_id": "string",
  "target_id": "string",
  "target_type": "knowledge|persona",
  "created_at": "datetime"
}
```

### é‚®ä»¶é…ç½®æ¨¡å‹

```json
{
  "mail_host": "string",
  "mail_user": "string",
  "mail_port": "integer",
  "mail_pwd": "string"
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç«¯ç‚¹æ¸…å•](./ç«¯ç‚¹æ¸…å•.md) - APIç«¯ç‚¹å®Œæ•´æ¸…å•
- [æ›´æ–°æ€»ç»“](./æ›´æ–°æ€»ç»“.md) - æ›´æ–°å†…å®¹æ€»ç»“
- [CHANGELOG.md](./CHANGELOG.md) - å˜æ›´æ—¥å¿—
- [æ•°æ®åº“æ¨¡å‹æ–‡æ¡£](./database_models.md) - æ•°æ®åº“ç»“æ„è¯´æ˜

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0  
**æœ€åæ›´æ–°**: 2025-11-22  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
```