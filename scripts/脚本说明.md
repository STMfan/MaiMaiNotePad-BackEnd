# Scripts è„šæœ¬ç›®å½•

æœ¬ç›®å½•åŒ…å«é¡¹ç›®ç»´æŠ¤ã€æµ‹è¯•å’Œå¼€å‘ç›¸å…³çš„è„šæœ¬å·¥å…·ã€‚

## âš ï¸ é‡è¦è¯´æ˜

**æ‰€æœ‰è„šæœ¬éƒ½å¿…é¡»ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ**ï¼Œä¸è¦åœ¨ `scripts/` ç›®å½•ä¸‹è¿è¡Œã€‚

æ­£ç¡®ç¤ºä¾‹ï¼š
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ
python scripts/python/reset_security_env.py
bash scripts/shell/cleanup.sh
```

é”™è¯¯ç¤ºä¾‹ï¼š
```bash
# âŒ ä¸è¦è¿™æ ·åš
cd scripts/python
python reset_security_env.py  # ä¼šæ‰¾ä¸åˆ° .env æ–‡ä»¶
```

## ğŸ“ ç›®å½•ç»“æ„

```
scripts/
â”œâ”€â”€ è„šæœ¬è¯´æ˜.md        # æœ¬æ–‡æ¡£
â”œâ”€â”€ python/            # Python è„šæœ¬
â”‚   â”œâ”€â”€ check_version.py
â”‚   â”œâ”€â”€ generate_error_codes_doc.py
â”‚   â”œâ”€â”€ generate_test_templates.py
â”‚   â””â”€â”€ reset_security_env.py
â””â”€â”€ shell/             # Shell è„šæœ¬
    â”œâ”€â”€ alembic.sh
    â”œâ”€â”€ cleanup.sh
    â””â”€â”€ run_parallel_isolation_tests.sh
```

## ğŸ Python è„šæœ¬

### check_version.py
**åŠŸèƒ½**: ç‰ˆæœ¬å·æ£€æŸ¥å·¥å…·

**ç”¨é€”**:
- éªŒè¯ç‰ˆæœ¬å·é…ç½®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ‰€æœ‰ä½ç½®çš„ç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´
- æ˜¾ç¤ºç‰ˆæœ¬å†å²è®°å½•
- ç¡®è®¤åŠ¨æ€ç‰ˆæœ¬å·é…ç½®å·¥ä½œæ­£å¸¸

**ä½¿ç”¨æ–¹æ³•**:
```bash
python scripts/python/check_version.py
```

**è¾“å‡ºç¤ºä¾‹**:
```
============================================================
ç‰ˆæœ¬å·æ£€æŸ¥
============================================================

âœ“ app.__version__.__version__: 2.0.0
âœ“ app.__version__.__version_info__: (2, 0, 0)
âœ“ app.__version__: 2.0.0
âœ“ settings.APP_VERSION: 2.0.0
âœ“ pyproject.toml dynamic: ['version']
âœ“ version source: app.__version__.__version__

ç‰ˆæœ¬å†å²:
  â€¢ 2.0.0: 2026-02-22 - é¡¹ç›®é‡æ„å®Œæˆ

============================================================
âœ… å½“å‰ç‰ˆæœ¬: 2.0.0
âœ… ç‰ˆæœ¬å·é…ç½®æ­£ç¡®ï¼
============================================================

ğŸ’¡ æç¤ºï¼š
   è¦æ›´æ–°ç‰ˆæœ¬å·ï¼Œåªéœ€ä¿®æ”¹ app/__version__.py æ–‡ä»¶
   pyproject.toml ä¼šè‡ªåŠ¨ä»é‚£é‡Œè¯»å–ç‰ˆæœ¬å·
```

**ç›¸å…³æ–‡æ¡£**: [ç‰ˆæœ¬ç®¡ç†æŒ‡å—](../docs/ç‰ˆæœ¬ç®¡ç†.md)

---

### generate_error_codes_doc.py
**åŠŸèƒ½**: è‡ªåŠ¨ç”Ÿæˆé”™è¯¯ç æ–‡æ¡£

**ç”¨é€”**:
- ä» `app/error_messages.json` è¯»å–é”™è¯¯æ¶ˆæ¯
- è‡ªåŠ¨ç”Ÿæˆ `docs/README_ERROR_CODES.md` æ–‡æ¡£
- æŒ‰æ¨¡å—åˆ†ç±»é”™è¯¯ç 
- åŒ…å«ä¸­è‹±æ–‡é”™è¯¯æ¶ˆæ¯

**ä½¿ç”¨æ–¹æ³•**:
```bash
python scripts/python/generate_error_codes_doc.py
```

**è¾“å‡º**: `docs/README_ERROR_CODES.md`

---

### generate_test_templates.py
**åŠŸèƒ½**: æµ‹è¯•æ¨¡æ¿ç”Ÿæˆå™¨

**ç”¨é€”**:
- åˆ†æä»£ç è¦†ç›–ç‡ï¼Œæ‰¾å‡ºæœªè¦†ç›–çš„ä»£ç 
- è‡ªåŠ¨ä¸ºè¦†ç›–ç‡ä½çš„æ–‡ä»¶ç”Ÿæˆæµ‹è¯•æ¨¡æ¿
- å¸®åŠ©æå‡æµ‹è¯•è¦†ç›–ç‡ï¼ˆå½“å‰ï¼š91%ï¼‰

**å‰ç½®æ¡ä»¶**:
```bash
# 1. å…ˆç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app --cov-report=json --cov-report=term-missing

# è¿™ä¼šç”Ÿæˆ coverage.json æ–‡ä»¶
```

**ä½¿ç”¨æ–¹æ³•**:
```bash
python scripts/python/generate_test_templates.py
```

**è¾“å‡º**: 
- æ˜¾ç¤ºè¦†ç›–ç‡æœ€ä½çš„ 10 ä¸ªæ–‡ä»¶
- ä¸ºè¦†ç›–ç‡ä½äº 50% çš„æ–‡ä»¶ç”Ÿæˆæµ‹è¯•æ¨¡æ¿
- æµ‹è¯•æ–‡ä»¶ä¿å­˜åœ¨ `tests/test_*_generated.py`

**æ³¨æ„**:
- ç”Ÿæˆçš„æµ‹è¯•åªæ˜¯æ¨¡æ¿ï¼Œéœ€è¦æ‰‹åŠ¨å®Œå–„
- ä¸ä¼šè¦†ç›–å·²å­˜åœ¨çš„æµ‹è¯•æ–‡ä»¶
- å»ºè®®å®šæœŸè¿è¡Œä»¥è¯†åˆ«æœªæµ‹è¯•çš„ä»£ç 

**ç¤ºä¾‹è¾“å‡º**:
```
å‘ç° 15 ä¸ªæ–‡ä»¶éœ€è¦æå‡è¦†ç›–ç‡:
  app/utils/helper.py: 45.2% (23 è¡Œæœªè¦†ç›–)
  app/services/cache.py: 67.8% (12 è¡Œæœªè¦†ç›–)
  
ç”Ÿæˆæµ‹è¯•æ¨¡æ¿...
  âœ“ ç”Ÿæˆ: tests/test_utils_helper_generated.py
  âŠ— è·³è¿‡: tests/test_services_cache_generated.py (å·²å­˜åœ¨)
```

---

### reset_security_env.py
**åŠŸèƒ½**: æ¸…æ¡£è„šæœ¬ - é‡ç½®å®‰å…¨ç¯å¢ƒå’Œæ•°æ®åº“

**ç”¨é€”**:
- é‡æ–°ç”Ÿæˆ JWT å¯†é’¥ã€è¶…çº§ç®¡ç†å‘˜å¯†ç ã€æœ€é«˜æƒé™å¯†ç 
- åˆ é™¤å¹¶é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
- æ¸…ç©º uploads å’Œ logs ç›®å½•
- ç”¨äºæœ¬æœºå¼€å‘æµ‹è¯•æˆ–ä¸Šçº¿å‰æ¸…æ¡£

**ä½¿ç”¨æ–¹æ³•**:
```bash
# å¿…é¡»ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python scripts/python/reset_security_env.py
```

**äº¤äº’ç¡®è®¤**: è„šæœ¬ä¼šè¦æ±‚è¾“å…¥ `RESET` ç¡®è®¤æ‰§è¡Œ

**è­¦å‘Š**: 
- âš ï¸ æ­¤æ“ä½œä¸å¯æ’¤é”€
- âš ï¸ ä»…ç”¨äºå¼€å‘ç¯å¢ƒæˆ–ä¸Šçº¿å‰æ¸…æ¡£
- âš ï¸ åˆ‡å‹¿åœ¨æ­£åœ¨è¿è¡Œçš„ç”Ÿäº§æœºå™¨ä¸Šæ‰§è¡Œ
- âš ï¸ ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®åº“æ•°æ®å’Œä¸Šä¼ æ–‡ä»¶

---

## ğŸš Shell è„šæœ¬

### cleanup.sh
**åŠŸèƒ½**: é¡¹ç›®æ¸…ç†è„šæœ¬ï¼ˆå¢å¼ºç‰ˆï¼‰

**æ¸…ç†å†…å®¹**:

1. **Python ç¼“å­˜**
   - `__pycache__` ç›®å½•
   - `*.pyc`, `*.pyo`, `*.pyd` æ–‡ä»¶

2. **æµ‹è¯•ç›¸å…³**
   - `.pytest_cache`, `.hypothesis` ç¼“å­˜
   - `.coverage`, `htmlcov` è¦†ç›–ç‡æ–‡ä»¶
   - `.tox`, `.mypy_cache`, `.ruff_cache`
   - æµ‹è¯•æ•°æ®åº“ (`test_*.db*`)
   - æµ‹è¯•æ—¥å¿—å’Œä¸´æ—¶æ–‡ä»¶

3. **æ„å»ºäº§ç‰©**
   - `build/`, `dist/` ç›®å½•
   - `*.egg-info`, `.eggs/` ç›®å½•

4. **ç¼–è¾‘å™¨ä¸´æ—¶æ–‡ä»¶**
   - Vim: `*~`, `*.swp`, `*.swo`, `*.swn`
   - Emacs: `#*#`, `.#*`
   - VS Code: `.vscode/.ropeproject`

5. **ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶**
   - macOS: `.DS_Store`, `._*`
   - Windows: `Thumbs.db`, `desktop.ini`
   - SQLite: `*.db-journal`, `*.db-wal`, `*.db-shm`

6. **å¯é€‰æ¸…ç†**ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
   - æ—¥å¿—æ–‡ä»¶ (`logs/*.log`)
   - pip ç¼“å­˜
   - å¤‡ä»½æ–‡ä»¶ (`*.bak`, `*.backup`, `*.old`)

**ä½¿ç”¨æ–¹æ³•**:
```bash
bash scripts/shell/cleanup.sh
```

**ç‰¹æ€§**:
- âœ… å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°æ˜“è¯»
- âœ… æ˜¾ç¤ºæ¸…ç†ç»Ÿè®¡ä¿¡æ¯
- âœ… å¯é€‰æ¸…ç†é¡¹éœ€è¦ç”¨æˆ·ç¡®è®¤
- âœ… å®‰å…¨é”™è¯¯å¤„ç†

**å»ºè®®**: 
- æ¯å‘¨è¿è¡Œä¸€æ¬¡ä¿æŒé¡¹ç›®æ•´æ´
- æäº¤ä»£ç å‰è¿è¡Œ
- åˆ‡æ¢åˆ†æ”¯å‰è¿è¡Œ

**ç¤ºä¾‹è¾“å‡º**:
```
ğŸ§¹ å¼€å§‹æ¸…ç†é¡¹ç›®...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â„¹ï¸  ğŸ“¦ æ¸…ç† Python ç¼“å­˜...
âœ…   æ¸…ç†äº† 45 ä¸ª __pycache__ ç›®å½•
âœ…   æ¸…ç†äº† 123 ä¸ª .pyc æ–‡ä»¶

â„¹ï¸  ğŸ§ª æ¸…ç†æµ‹è¯•ç›¸å…³æ–‡ä»¶...
âœ…   æ¸…ç†äº† .pytest_cache
âœ…   æ¸…ç†äº† 15 ä¸ªæµ‹è¯•æ•°æ®åº“æ–‡ä»¶

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… âœ¨ æ¸…ç†å®Œæˆï¼å…±æ¸…ç†äº† 183 é¡¹
```

---

### run_parallel_isolation_tests.sh
**åŠŸèƒ½**: è¿è¡Œå¹¶è¡Œéš”ç¦»æµ‹è¯•

**ç”¨é€”**:
- å•ç‹¬è¿è¡Œå¹¶è¡Œéš”ç¦»æµ‹è¯•
- éªŒè¯æµ‹è¯•å¥—ä»¶çš„å¹¶è¡Œæ‰§è¡Œéš”ç¦»æ€§
- æµ‹è¯•ç¼“å­˜éš”ç¦»ã€ä¾èµ–æ³¨å…¥éš”ç¦»ç­‰

**ä½¿ç”¨æ–¹æ³•**:
```bash
bash scripts/shell/run_parallel_isolation_tests.sh
```

**è¯´æ˜**: è¿™äº›æµ‹è¯•å†…éƒ¨ä¼šå¯åŠ¨å¹¶è¡Œæµ‹è¯•ï¼Œä¸åº”åœ¨ä¸»æµ‹è¯•å¥—ä»¶ä¸­è¿è¡Œ

**è¾“å‡ºç¤ºä¾‹**:
```
==========================================
Running Parallel Isolation Tests
==========================================

Test 1: Parallel Execution Isolation
--------------------------------------
âœ“ PASSED

Test 2: Authenticated Client Isolation
--------------------------------------
âœ“ PASSED

Test 3: Single Test Execution Preservation
--------------------------------------
âœ“ PASSED

==========================================
Summary
==========================================
âœ“ All parallel isolation tests passed
```

---

## ğŸ“‹ ä½¿ç”¨åœºæ™¯

### æ—¥å¸¸å¼€å‘
```bash
# æ£€æŸ¥ç‰ˆæœ¬å·
python scripts/python/check_version.py

# æ¸…ç†é¡¹ç›®
bash scripts/shell/cleanup.sh

# ç”Ÿæˆé”™è¯¯ç æ–‡æ¡£
python scripts/python/generate_error_codes_doc.py

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/
```

### æµ‹è¯•ç›¸å…³
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/

# è¿è¡Œå¹¶è¡Œéš”ç¦»æµ‹è¯•
bash scripts/shell/run_parallel_isolation_tests.sh

# æ¸…ç†é¡¹ç›®ï¼ˆåŒ…æ‹¬æµ‹è¯•æ–‡ä»¶ï¼‰
bash scripts/shell/cleanup.sh
```

### æ–‡æ¡£ç»´æŠ¤
```bash
# ç”Ÿæˆé”™è¯¯ç æ–‡æ¡£
python scripts/python/generate_error_codes_doc.py
```

### æµ‹è¯•è¦†ç›–ç‡æå‡
```bash
# 1. ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app --cov-report=json --cov-report=term-missing

# 2. ç”Ÿæˆæµ‹è¯•æ¨¡æ¿
python scripts/python/generate_test_templates.py

# 3. å®Œå–„ç”Ÿæˆçš„æµ‹è¯•
# ç¼–è¾‘ tests/test_*_generated.py æ–‡ä»¶

# 4. è¿è¡Œæ–°æµ‹è¯•
pytest tests/test_*_generated.py
```

### ç¯å¢ƒé…ç½®
```bash
# é‡ç½®å®‰å…¨ç¯å¢ƒï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
# âš ï¸ å¿…é¡»ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python scripts/python/reset_security_env.py
```

**é‡è¦æç¤º**:
- è„šæœ¬ä¼šè¦æ±‚è¾“å…¥ `RESET` ç¡®è®¤
- ä¼šé‡æ–°ç”Ÿæˆ JWT å¯†é’¥ã€è¶…çº§ç®¡ç†å‘˜å¯†ç ã€æœ€é«˜æƒé™å¯†ç 
- ä¼šåˆ é™¤å¹¶é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
- ä¼šæ¸…ç©º uploads å’Œ logs ç›®å½•
- æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œä»…ç”¨äºå¼€å‘ç¯å¢ƒæˆ–ä¸Šçº¿å‰æ¸…æ¡£

---

## ğŸ”§ ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ¸…ç†**: æ¯å‘¨è¿è¡Œ `cleanup.sh` ä¿æŒé¡¹ç›®æ•´æ´
2. **æµ‹è¯•éªŒè¯**: ä½¿ç”¨ `run_parallel_isolation_tests.sh` éªŒè¯å¹¶è¡Œéš”ç¦»
3. **æ–‡æ¡£åŒæ­¥**: ä¿®æ”¹é”™è¯¯æ¶ˆæ¯åè¿è¡Œ `generate_error_codes_doc.py`
4. **æäº¤å‰æ£€æŸ¥**: è¿è¡Œæ¸…ç†è„šæœ¬ç¡®ä¿ä¸æäº¤ä¸´æ—¶æ–‡ä»¶

---

## ğŸ“ æ·»åŠ æ–°è„šæœ¬

æ·»åŠ æ–°è„šæœ¬æ—¶ï¼š

1. **é€‰æ‹©ç›®å½•**:
   - Python è„šæœ¬ â†’ `scripts/python/`
   - Shell è„šæœ¬ â†’ `scripts/shell/`

2. **æ·»åŠ æ‰§è¡Œæƒé™**:
   ```bash
   chmod +x scripts/shell/your_script.sh
   ```

3. **æ›´æ–°æ–‡æ¡£**: åœ¨æœ¬ README ä¸­æ·»åŠ è„šæœ¬è¯´æ˜

4. **æ·»åŠ æ³¨é‡Š**: åœ¨è„šæœ¬å¼€å¤´æ·»åŠ åŠŸèƒ½è¯´æ˜

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•æ–‡æ¡£](../tests/docs/æµ‹è¯•è¯´æ˜.md)
- [API æ–‡æ¡£](../docs/APIæ–‡æ¡£.md)
- [æ¶æ„æ–‡æ¡£](../docs/æ¶æ„æ–‡æ¡£.md)
- [é”™è¯¯ç æ–‡æ¡£](../docs/é”™è¯¯ç æ–‡æ¡£.md)
